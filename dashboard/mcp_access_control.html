<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MCP Access Control Dashboard</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f5f5f5;
            color: #333;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 2rem;
            border-radius: 12px;
            margin-bottom: 2rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
        }
        
        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }
        
        .dashboard-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
            margin-bottom: 2rem;
        }
        
        .card {
            background: white;
            border-radius: 12px;
            padding: 1.5rem;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            border: 1px solid #e1e5e9;
        }
        
        .card h2 {
            color: #2d3748;
            margin-bottom: 1rem;
            font-size: 1.5rem;
        }
        
        .role-selector {
            margin-bottom: 1.5rem;
        }
        
        .role-selector select {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid #e1e5e9;
            border-radius: 6px;
            font-size: 1rem;
        }
        
        .access-matrix {
            width: 100%;
            border-collapse: collapse;
            margin-top: 1rem;
        }
        
        .access-matrix th,
        .access-matrix td {
            padding: 0.75rem;
            text-align: left;
            border-bottom: 1px solid #e1e5e9;
        }
        
        .access-matrix th {
            background-color: #f8f9fa;
            font-weight: 600;
            color: #2d3748;
        }
        
        .access-level {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 500;
        }
        
        .access-none {
            background-color: #fed7d7;
            color: #c53030;
        }
        
        .access-read_only {
            background-color: #fef2de;
            color: #d69e2e;
        }
        
        .access-limited_write {
            background-color: #bee3f8;
            color: #2b6cb0;
        }
        
        .access-full_write {
            background-color: #c6f6d5;
            color: #2f855a;
        }
        
        .access-admin {
            background-color: #e9d8fd;
            color: #6b46c1;
        }
        
        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 6px;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.3s ease;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }
        
        .btn-secondary {
            background: #718096;
        }
        
        .btn-danger {
            background: #e53e3e;
        }
        
        .permissions-list {
            list-style: none;
        }
        
        .permissions-list li {
            padding: 0.5rem 0;
            border-bottom: 1px solid #e1e5e9;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .permissions-list li:last-child {
            border-bottom: none;
        }
        
        .onboarding-stage {
            background: #f7fafc;
            padding: 1rem;
            border-radius: 8px;
            margin: 1rem 0;
            border-left: 4px solid #667eea;
        }
        
        .stage-indicator {
            display: flex;
            align-items: center;
            margin-bottom: 0.5rem;
        }
        
        .stage-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 0.5rem;
        }
        
        .stage-observer {
            background-color: #fed7d7;
        }
        
        .stage-participant {
            background-color: #fef2de;
        }
        
        .stage-trusted {
            background-color: #c6f6d5;
        }
        
        .violations-log {
            max-height: 400px;
            overflow-y: auto;
            background: #f8f9fa;
            border-radius: 6px;
            padding: 1rem;
        }
        
        .violation-entry {
            background: white;
            padding: 0.75rem;
            margin-bottom: 0.5rem;
            border-radius: 6px;
            border-left: 4px solid #e53e3e;
        }
        
        .violation-entry:last-child {
            margin-bottom: 0;
        }
        
        .tabs {
            display: flex;
            border-bottom: 1px solid #e1e5e9;
            margin-bottom: 1.5rem;
        }
        
        .tab {
            padding: 0.75rem 1.5rem;
            cursor: pointer;
            border-bottom: 2px solid transparent;
            transition: all 0.3s ease;
        }
        
        .tab.active {
            color: #667eea;
            border-bottom-color: #667eea;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        @media (max-width: 768px) {
            .dashboard-grid {
                grid-template-columns: 1fr;
            }
            
            .header h1 {
                font-size: 2rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>MCP Access Control Dashboard</h1>
            <p>Manage role-based access control for MCP servers and progressive onboarding</p>
        </div>
        
        <div class="dashboard-grid">
            <div class="card">
                <h2>Role Access Management</h2>
                <div class="role-selector">
                    <select id="roleSelect" onchange="loadRolePermissions()">
                        <option value="">Select a role...</option>
                        <option value="Founder">Founder</option>
                        <option value="Investor">Investor</option>
                        <option value="CEO">CEO</option>
                        <option value="CFO">CFO</option>
                        <option value="CMO">CMO</option>
                        <option value="CTO">CTO</option>
                        <option value="CHRO">CHRO</option>
                        <option value="Employee">Employee</option>
                    </select>
                </div>
                
                <div id="rolePermissions" style="display: none;">
                    <table class="access-matrix">
                        <thead>
                            <tr>
                                <th>MCP Server</th>
                                <th>Access Level</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="accessMatrixBody">
                        </tbody>
                    </table>
                    
                    <div style="margin-top: 1rem;">
                        <button class="btn" onclick="saveRolePermissions()">Save Changes</button>
                        <button class="btn btn-secondary" onclick="resetRolePermissions()">Reset</button>
                    </div>
                </div>
            </div>
            
            <div class="card">
                <h2>Progressive Onboarding</h2>
                <div id="onboardingInfo">
                    <div class="onboarding-stage">
                        <div class="stage-indicator">
                            <div class="stage-dot stage-observer"></div>
                            <strong>Observer Stage (7 days)</strong>
                        </div>
                        <p>Read-only access to basic business data</p>
                        <small>Max 10 queries/hour</small>
                    </div>
                    
                    <div class="onboarding-stage">
                        <div class="stage-indicator">
                            <div class="stage-dot stage-participant"></div>
                            <strong>Participant Stage (30 days)</strong>
                        </div>
                        <p>Limited write access to non-critical systems</p>
                        <small>Max 50 queries/hour</small>
                    </div>
                    
                    <div class="onboarding-stage">
                        <div class="stage-indicator">
                            <div class="stage-dot stage-trusted"></div>
                            <strong>Trusted Stage (Permanent)</strong>
                        </div>
                        <p>Full access to business operations</p>
                        <small>Max 200 queries/hour</small>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="card">
            <div class="tabs">
                <div class="tab active" onclick="switchTab('permissions')">Current Permissions</div>
                <div class="tab" onclick="switchTab('violations')">Access Violations</div>
                <div class="tab" onclick="switchTab('config')">Configuration</div>
            </div>
            
            <div id="permissions-tab" class="tab-content active">
                <div class="role-selector">
                    <select id="userRoleSelect" onchange="loadUserPermissions()">
                        <option value="">Select user role...</option>
                        <option value="Founder">Founder</option>
                        <option value="Investor">Investor</option>
                        <option value="CEO">CEO</option>
                        <option value="CFO">CFO</option>
                        <option value="CMO">CMO</option>
                        <option value="CTO">CTO</option>
                        <option value="CHRO">CHRO</option>
                        <option value="Employee">Employee</option>
                    </select>
                </div>
                <div id="userPermissionsDisplay"></div>
            </div>
            
            <div id="violations-tab" class="tab-content">
                <div style="margin-bottom: 1rem;">
                    <button class="btn btn-secondary" onclick="loadViolations()">Refresh Violations</button>
                    <select id="violationTimeframe" onchange="loadViolations()">
                        <option value="1">Last 1 hour</option>
                        <option value="24" selected>Last 24 hours</option>
                        <option value="168">Last week</option>
                    </select>
                </div>
                <div id="violationsList" class="violations-log">
                    <p>Loading violations...</p>
                </div>
            </div>
            
            <div id="config-tab" class="tab-content">
                <h3>System Configuration</h3>
                <div style="margin-bottom: 1rem;">
                    <label><strong>Audit Logging:</strong></label>
                    <input type="checkbox" id="auditEnabled" checked> Enable audit logging
                </div>
                <div style="margin-bottom: 1rem;">
                    <label><strong>Alert on Violations:</strong></label>
                    <input type="checkbox" id="alertsEnabled" checked> Enable violation alerts
                </div>
                <div style="margin-bottom: 1rem;">
                    <label><strong>Log Retention (days):</strong></label>
                    <input type="number" id="retentionDays" value="90" min="1" max="365">
                </div>
                <button class="btn" onclick="saveConfiguration()">Save Configuration</button>
            </div>
        </div>
    </div>

    <script>
        // Mock data for demonstration
        const mockAccessLevels = {
            'none': 'none',
            'read_only': 'read_only', 
            'limited_write': 'limited_write',
            'full_write': 'full_write',
            'admin': 'admin'
        };
        
        const mockRolePermissions = {
            'Founder': {
                'linkedin': 'admin',
                'reddit': 'full_write',
                'erpnext': 'admin',
                'businessinfinity_config': 'admin'
            },
            'CEO': {
                'linkedin': 'full_write',
                'reddit': 'full_write',
                'erpnext': 'admin',
                'businessinfinity_config': 'full_write'
            },
            'CFO': {
                'linkedin': 'limited_write',
                'reddit': 'read_only',
                'erpnext': 'admin',
                'businessinfinity_config': 'limited_write'
            },
            'Employee': {
                'linkedin': 'none',
                'reddit': 'none',
                'erpnext': 'read_only',
                'businessinfinity_config': 'none'
            }
        };
        
        const mockViolations = [
            {
                user_role: 'Employee',
                mcp_server: 'linkedin',
                operation: 'create',
                reason: 'Access level none does not permit operation create',
                timestamp: new Date().toISOString(),
                severity: 'medium'
            },
            {
                user_role: 'Investor',
                mcp_server: 'erpnext',
                operation: 'delete',
                reason: 'Access level read_only does not permit operation delete',
                timestamp: new Date(Date.now() - 3600000).toISOString(),
                severity: 'high'
            }
        ];
        
        function loadRolePermissions() {
            const roleSelect = document.getElementById('roleSelect');
            const role = roleSelect.value;
            const permissionsDiv = document.getElementById('rolePermissions');
            const matrixBody = document.getElementById('accessMatrixBody');
            
            if (!role) {
                permissionsDiv.style.display = 'none';
                return;
            }
            
            permissionsDiv.style.display = 'block';
            
            const permissions = mockRolePermissions[role] || {};
            const servers = ['linkedin', 'reddit', 'erpnext', 'businessinfinity_config'];
            
            matrixBody.innerHTML = '';
            servers.forEach(server => {
                const row = document.createElement('tr');
                const accessLevel = permissions[server] || 'none';
                
                row.innerHTML = `
                    <td><strong>${server}</strong></td>
                    <td>
                        <span class="access-level access-${accessLevel}">${accessLevel}</span>
                    </td>
                    <td>
                        <select onchange="updateAccess('${role}', '${server}', this.value)">
                            ${Object.keys(mockAccessLevels).map(level => 
                                `<option value="${level}" ${level === accessLevel ? 'selected' : ''}>${level}</option>`
                            ).join('')}
                        </select>
                    </td>
                `;
                matrixBody.appendChild(row);
            });
        }
        
        function updateAccess(role, server, newLevel) {
            if (!mockRolePermissions[role]) {
                mockRolePermissions[role] = {};
            }
            mockRolePermissions[role][server] = newLevel;
            loadRolePermissions(); // Refresh the display
        }
        
        function saveRolePermissions() {
            alert('Role permissions saved successfully!');
            // In real implementation, this would make API call to save permissions
        }
        
        function resetRolePermissions() {
            loadRolePermissions();
            alert('Permissions reset to original values.');
        }
        
        function loadUserPermissions() {
            const userRoleSelect = document.getElementById('userRoleSelect');
            const role = userRoleSelect.value;
            const display = document.getElementById('userPermissionsDisplay');
            
            if (!role) {
                display.innerHTML = '';
                return;
            }
            
            // Mock user permissions data
            const mockUserProfile = {
                role: role,
                onboarding_stage: role === 'Employee' ? 'observer' : 'trusted',
                stage_started: new Date(Date.now() - 86400000).toISOString(),
                days_in_stage: 1,
                mcp_access: mockRolePermissions[role] || {},
                restrictions: role === 'Employee' ? { max_queries_per_hour: 10 } : {},
                recent_usage: {}
            };
            
            display.innerHTML = `
                <div class="onboarding-stage">
                    <h4>User Profile: ${role}</h4>
                    <p><strong>Onboarding Stage:</strong> ${mockUserProfile.onboarding_stage}</p>
                    <p><strong>Days in Stage:</strong> ${mockUserProfile.days_in_stage}</p>
                    <p><strong>Restrictions:</strong> ${JSON.stringify(mockUserProfile.restrictions)}</p>
                </div>
            `;
        }
        
        function loadViolations() {
            const violationsList = document.getElementById('violationsList');
            
            violationsList.innerHTML = '';
            mockViolations.forEach(violation => {
                const div = document.createElement('div');
                div.className = 'violation-entry';
                div.innerHTML = `
                    <p><strong>${violation.user_role}</strong> attempted <strong>${violation.operation}</strong> on <strong>${violation.mcp_server}</strong></p>
                    <p><em>${violation.reason}</em></p>
                    <small>Severity: ${violation.severity} | ${new Date(violation.timestamp).toLocaleString()}</small>
                `;
                violationsList.appendChild(div);
            });
        }
        
        function switchTab(tabName) {
            // Remove active class from all tabs and tab contents
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            
            // Add active class to clicked tab and corresponding content
            event.target.classList.add('active');
            document.getElementById(`${tabName}-tab`).classList.add('active');
            
            if (tabName === 'violations') {
                loadViolations();
            }
        }
        
        function saveConfiguration() {
            const auditEnabled = document.getElementById('auditEnabled').checked;
            const alertsEnabled = document.getElementById('alertsEnabled').checked;
            const retentionDays = document.getElementById('retentionDays').value;
            
            alert(`Configuration saved:
Audit Logging: ${auditEnabled}
Alerts: ${alertsEnabled}
Retention: ${retentionDays} days`);
        }
        
        // Initialize the page
        document.addEventListener('DOMContentLoaded', function() {
            loadViolations();
        });
    </script>
</body>
</html>